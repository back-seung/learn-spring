package learningspring.chap08.config;import learningspring.chap08.printer.MemberInfoPrinter;import learningspring.chap08.printer.MemberPrinter;import learningspring.chap08.dao.MemberDao;import learningspring.chap08.printer.MemberListPrinter;import learningspring.chap08.service.ChangePasswordService;import learningspring.chap08.service.MemberRegisterService;import org.apache.tomcat.jdbc.pool.DataSource;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.jdbc.datasource.DataSourceTransactionManager;import org.springframework.transaction.PlatformTransactionManager;import org.springframework.transaction.annotation.EnableTransactionManagement;@Configuration@EnableTransactionManagementpublic class AppCtx {    @Bean(destroyMethod = "close")    public DataSource dataSource() {        DataSource dataSource = new DataSource();        dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");        dataSource.setUrl("jdbc:mysql://localhost/spring5fs?characterEncoding=utf8");        dataSource.setUsername("spring5");        dataSource.setPassword("spring5");        dataSource.setInitialSize(2);        dataSource.setMaxActive(10);        dataSource.setTestWhileIdle(true);        dataSource.setMinEvictableIdleTimeMillis(60000 * 3);        dataSource.setTimeBetweenEvictionRunsMillis(10 * 1000);        return dataSource;    }    @Bean    public PlatformTransactionManager platformTransactionManager() {        DataSourceTransactionManager tm = new DataSourceTransactionManager();        tm.setDataSource(dataSource());        return tm;    }    @Bean    public MemberDao memberDao() {        return new MemberDao(dataSource());    }    @Bean    public MemberRegisterService memberRegisterService() {        return new MemberRegisterService(memberDao());    }    @Bean    public ChangePasswordService changePasswordService() {        ChangePasswordService changePasswordService = new ChangePasswordService();        changePasswordService.setMemberDao(memberDao());        return changePasswordService;    }    @Bean    public MemberPrinter memberPrinter() {        return new MemberPrinter();    }    @Bean    public MemberListPrinter memberListPrinter() {        return new MemberListPrinter(memberDao(), memberPrinter());    }    @Bean    public MemberInfoPrinter memberInfoPrinter() {        MemberInfoPrinter memberInfoPrinter = new MemberInfoPrinter();        memberInfoPrinter.setMemberDao(memberDao());        memberInfoPrinter.setMemberPrinter(memberPrinter());        return memberInfoPrinter;    }}